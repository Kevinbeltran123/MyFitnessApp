# üìã Plan de Mejora de Funcionalidades de Tracking
## My Fitness Tracker - Roadmap Completo de Implementaci√≥n

> **Proyecto:** Aplicaci√≥n Flutter de Fitness
> **Stack:** Flutter + Isar + Riverpod
> **Duraci√≥n:** 4 semanas
> **Objetivo:** Mejorar tracking, analytics, y experiencia de usuario

---

## üìä Estado Actual del Proyecto

### ‚úÖ Funcionalidades Completadas (Fase 1 ~90%)

#### Sistema de Rutinas
- [x] Modelos de dominio (`Routine`, `RoutineExercise`, `RoutineSet`)
- [x] Repositorio Isar para rutinas (`RoutineRepositoryIsar`)
- [x] `RoutineListScreen` con b√∫squeda y filtros avanzados
- [x] `RoutineBuilderScreen` con picker de ejercicios
- [x] `RoutineDetailScreen` con CRUD completo (duplicate, archive, delete)
- [x] Navegaci√≥n fluida entre pantallas de rutinas

#### Sistema de Sesiones de Entrenamiento
- [x] `RoutineSessionScreen` con modo en vivo
- [x] Timer de sesi√≥n global
- [x] Timer de descanso con pausar/reanudar
- [x] Logging de sets (reps, peso, descanso)
- [x] Registro de notas por sesi√≥n
- [x] C√°lculo de volumen total
- [x] Guardado de sesiones en Isar

#### Tracking de M√©tricas Corporales
- [x] Entidades de dominio (`BodyMetric`, `MetabolicProfile`)
- [x] Repositorio Isar para m√©tricas
- [x] `MetricsDashboardScreen` con resumen actual
- [x] `AddMeasurementScreen` para log de medidas
- [x] Gr√°ficos custom sin librer√≠as externas (`_SimpleLinePainter`)
- [x] C√°lculo de IMC y TMB (Mifflin-St Jeor)

#### Arquitectura y Base
- [x] Clean Architecture (domain/application/infrastructure/presentation)
- [x] Riverpod para gesti√≥n de estado
- [x] Isar como base de datos local
- [x] Tema personalizado con gradientes (`AppColors`)
- [x] Navegaci√≥n con bottom navigation (5 secciones)

### üöß Problemas Identificados

#### Cr√≠ticos
- [ ] **Persistencia Isar no validada** - No se ha verificado que datos sobrevivan reinicios de app
- [ ] **Tests unitarios bloqueados** - IsarCore download failures en ambiente de testing
- [ ] **Falta validaci√≥n de edge cases** - Estados vac√≠os, errores de red, datos inv√°lidos

#### No Cr√≠ticos
- [ ] Gr√°ficos b√°sicos (se pueden mejorar con fl_chart)
- [ ] Sin sistema de logros/gamificaci√≥n
- [ ] Sin onboarding para nuevos usuarios
- [ ] Sin modo oscuro
- [ ] Sin analytics avanzados (1RM, tendencias, comparativas)

---

## üéØ Plan de Implementaci√≥n - 4 Semanas

---

## üìÖ SEMANA 1: Persistencia y Validaci√≥n (CR√çTICO)

**Objetivo:** Asegurar que todos los datos persistan correctamente y resolver issues de testing

---

### M√≥dulo 1.1 - Validaci√≥n Manual de Persistencia Isar
**Prioridad:** üî¥ CR√çTICA
**Duraci√≥n:** 1 d√≠a
**Dependencias:** Ninguna

#### Tareas
- [ ] **Test Manual 1: Rutinas**
  - [ ] Crear 3 rutinas diferentes con ejercicios variados
  - [ ] Cerrar completamente la aplicaci√≥n (kill process)
  - [ ] Reabrir y verificar que las 3 rutinas existen
  - [ ] Verificar que sets, reps, y peso se mantienen
  - [ ] Verificar que d√≠as de semana se mantienen

- [ ] **Test Manual 2: M√©tricas**
  - [ ] Agregar 5 mediciones de peso con fechas diferentes
  - [ ] Agregar medidas corporales (grasa, m√∫sculo)
  - [ ] Configurar perfil metab√≥lico (altura, edad, sexo)
  - [ ] Reiniciar app
  - [ ] Verificar que todas las mediciones persisten
  - [ ] Verificar que gr√°ficos se generan correctamente

- [ ] **Test Manual 3: Sesiones de Entrenamiento**
  - [ ] Completar una sesi√≥n de entrenamiento completa
  - [ ] Log de al menos 5 sets con notas
  - [ ] Guardar sesi√≥n
  - [ ] Reiniciar app
  - [ ] Verificar en `WorkoutHistoryScreen` que aparece
  - [ ] Verificar que todos los sets y notas est√°n guardados

- [ ] **Test Manual 4: Estados Archivados**
  - [ ] Archivar 2 rutinas
  - [ ] Reiniciar app
  - [ ] Verificar que rutinas archivadas no aparecen en lista principal
  - [ ] Verificar que se pueden restaurar

#### Criterios de √âxito
- ‚úÖ 100% de datos persisten entre reinicios
- ‚úÖ No hay p√©rdida de informaci√≥n en ning√∫n flujo
- ‚úÖ Estados archivados se mantienen correctamente

---

### M√≥dulo 1.2 - Resoluci√≥n de Testing Infrastructure
**Prioridad:** üî¥ CR√çTICA
**Duraci√≥n:** 1 d√≠a
**Dependencias:** M√≥dulo 1.1

#### Tareas
- [x] **Investigar alternativas para testing de Isar**
  - [x] Documentar problema actual (IsarCore download en test environment)
  - [x] Evaluar usar `isar.open(directory: Directory.systemTemp.path, inspector: false)`
  - [x] Considerar mocks para capa de repositorio
  - [x] Evaluar integration tests en lugar de unit tests

- [x] **Crear suite de integration tests**
  - [x] Setup: `test/integration/database_persistence_test.dart`
  - [x] Test: Crear rutina ‚Üí leer rutina ‚Üí verificar igualdad
  - [x] Test: Crear m√©trica ‚Üí leer m√©trica ‚Üí verificar campos
  - [x] Test: Crear sesi√≥n ‚Üí consultar historial ‚Üí verificar datos
  - [x] Test: Archivar rutina ‚Üí consultar lista ‚Üí verificar filtrado

- [x] **Implementar test helpers**
  - [x] `TestIsarFactory` para crear instancias de Isar en tests
  - [x] `MockDataGenerator` para generar datos de prueba consistentes
  - [x] `DatabaseTestHelper` con m√©todos de limpieza entre tests

#### Criterios de √âxito
- ‚úÖ Al menos 10 integration tests pasando
- ‚úÖ Coverage de operaciones CRUD en todos los repositorios
- ‚úÖ Tests ejecutables en CI/CD (si aplica)

---

### M√≥dulo 1.3 - Mejoras al Dashboard de M√©tricas
**Prioridad:** üü° ALTA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** M√≥dulo 1.1

#### Tareas

##### 1.3.1 Selector de Rango Temporal
- [x] **Crear widget `MetricRangeSelector`**
  - [x] Opciones: 7 d√≠as, 30 d√≠as, 90 d√≠as, Todo
  - [x] Estado seleccionado con highlight visual
  - [x] Callback para cambio de rango
  - [x] Dise√±o con chips o segmented button

- [x] **Integrar en `MetricsDashboardScreen`**
  - [x] Agregar selector arriba de gr√°ficos
  - [x] Filtrar datos seg√∫n rango seleccionado
  - [x] Actualizar todos los gr√°ficos din√°micamente
  - [x] Persistir selecci√≥n en estado (Riverpod)

##### 1.3.2 Estad√≠sticas Comparativas
- [x] **Crear widget `ComparisonCard`**
  - [x] Mostrar cambio de peso: "+2.5 kg en 30 d√≠as"
  - [x] Mostrar cambio de grasa corporal: "-1.8% en 30 d√≠as"
  - [x] Mostrar cambio de m√∫sculo: "+1.2 kg en 30 d√≠as"
  - [x] Iconos de tendencia (‚Üë‚Üì) con colores sem√°nticos
  - [x] Animaci√≥n de entrada

- [x] **Calcular m√©tricas comparativas**
  - [x] Comparar primer vs √∫ltimo punto del rango
  - [x] Calcular porcentaje de cambio
  - [x] Calcular promedio del periodo
  - [x] Identificar tendencias (subiendo/bajando/estable)

##### 1.3.3 Indicadores de Progreso Avanzados
- [x] **Crear widget `TrendIndicator`**
  - [x] Mostrar l√≠nea de tendencia simple (regresi√≥n lineal b√°sica)
  - [x] Indicador visual de momentum
  - [x] Predicci√≥n simple del siguiente valor
  - [x] Dise√±o minimalista integrado en cards

- [x] **Mejorar gr√°ficos existentes**
  - [x] A√±adir marcadores de metas (l√≠nea horizontal)
  - [x] Resaltar m√°ximos y m√≠nimos del periodo
  - [x] Tooltips al tocar puntos de datos
  - [x] Smooth animations al cambiar rango

#### Estructura de Archivos
```
lib/presentation/metrics/
‚îú‚îÄ‚îÄ widgets/
‚îÇ   ‚îú‚îÄ‚îÄ metric_chart.dart (ya existe)
‚îÇ   ‚îú‚îÄ‚îÄ metric_range_selector.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ comparison_card.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ trend_indicator.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ bmi_calculator.dart (ya existe)
‚îú‚îÄ‚îÄ metrics_dashboard_screen.dart (MODIFICAR)
‚îî‚îÄ‚îÄ metrics_controller.dart (MODIFICAR)
```

#### Criterios de √âxito
- ‚úÖ Selector de rango funcional con 4 opciones
- ‚úÖ Comparativas muestran cambios reales
- ‚úÖ Gr√°ficos se actualizan suavemente al cambiar rango
- ‚úÖ Dise√±o consistente con el resto de la app

---

### M√≥dulo 1.4 - Validaci√≥n y Error Handling
**Prioridad:** üü° ALTA
**Duraci√≥n:** 1 d√≠a
**Dependencias:** Ninguna

#### Tareas

##### 1.4.1 Validaciones de Entrada
- [x] **En `AddMeasurementScreen`**
  - [x] Peso: m√≠nimo 20kg, m√°ximo 300kg
  - [x] Grasa corporal: 1% - 70%
  - [x] Masa muscular: 1kg - 150kg
  - [x] Fecha: no futuro, m√°ximo 2 a√±os atr√°s
  - [x] Mensajes de error claros en espa√±ol

- [x] **En `RoutineBuilderScreen`**
  - [x] Nombre rutina: m√≠nimo 3 caracteres
  - [x] Al menos 1 ejercicio seleccionado
  - [x] Al menos 1 d√≠a de semana seleccionado
  - [x] Sets: m√≠nimo 1, m√°ximo 10
  - [x] Reps: m√≠nimo 1, m√°ximo 100
  - [x] Peso: positivo o cero

- [x] **En `_LogSetSheet` (sesiones)**
  - [x] Reps completadas: m√≠nimo 0, m√°ximo 100
  - [x] Peso usado: m√≠nimo 0
  - [x] Descanso: m√≠nimo 0, m√°ximo 20 minutos

##### 1.4.2 Estados de Error y Vac√≠os
- [x] **Crear widgets reutilizables**
  - [x] `EmptyStateWidget` con icono, mensaje, y CTA
  - [x] `ErrorStateWidget` con retry button
  - [x] `LoadingStateWidget` consistente

- [x] **Aplicar en todas las pantallas**
  - [x] `RoutineListScreen`: "Sin rutinas creadas"
  - [x] `WorkoutHistoryScreen`: "Sin entrenamientos registrados"
  - [x] `MetricsDashboardScreen`: "Sin medidas registradas"
  - [x] `ExercisesScreen`: "Error al cargar ejercicios"

##### 1.4.3 Feedback de Operaciones
- [x] **Snackbars unificados**
  - [x] Success / Error centralizados con `AppSnackBar`
  - [x] Warnings reutilizables para validaciones
  - [x] Mensajes informativos consistentes en archivado/restauraci√≥n

- [x] **Progress indicators**
  - [x] Spinner en guardado de rutinas y m√©tricas
  - [x] Indicador de avance al finalizar sesiones
  - [x] Skeleton loaders en listados extensos (ejercicios)

#### Criterios de √âxito
- ‚úÖ Usuario no puede ingresar datos inv√°lidos
- ‚úÖ Todos los estados vac√≠os tienen mensajes √∫tiles
- ‚úÖ Errores se manejan gracefully sin crashes
- ‚úÖ Feedback visual inmediato en todas las acciones

---

## üìÖ SEMANA 2: Analytics y Visualizaci√≥n Avanzada

**Objetivo:** Implementar sistema de analytics con c√°lculos avanzados y gr√°ficos profesionales

---

### M√≥dulo 2.1 - Sistema de Analytics Avanzado
**Prioridad:** üü¢ MEDIA
**Duraci√≥n:** 3 d√≠as
**Dependencias:** Semana 1 completa

#### Tareas

##### 2.1.1 Servicio de Analytics
- [ ] **Crear `AnalyticsService` en `application/analytics/`**
  - [ ] M√©todo: `calculateWeeklyVolume(DateTime week) ‚Üí double`
  - [ ] M√©todo: `calculateMonthlyVolume(DateTime month) ‚Üí double`
  - [ ] M√©todo: `getVolumeByMuscleGroup(DateRange) ‚Üí Map<String, double>`
  - [ ] M√©todo: `calculateTrainingFrequency(DateRange) ‚Üí int`
  - [ ] M√©todo: `calculateConsistency(DateRange) ‚Üí double` (%)
  - [ ] M√©todo: `estimateOneRepMax(Exercise, weight, reps) ‚Üí double`

- [ ] **Implementar entidades de analytics en `domain/analytics/`**
  - [ ] `WorkoutStats` (volumen, sets, duraci√≥n, frecuencia)
  - [ ] `MuscleGroupStats` (volumen por grupo, frecuencia)
  - [ ] `ExerciseProgress` (hist√≥rico de peso/reps, PRs)
  - [ ] `ConsistencyMetrics` (streaks, d√≠as activos, tasa cumplimiento)

##### 2.1.2 C√°lculos de Fuerza
- [ ] **Implementar f√≥rmulas de 1RM**
  - [ ] F√≥rmula Brzycki: `weight / (1.0278 - 0.0278 * reps)`
  - [ ] F√≥rmula Epley: `weight * (1 + 0.0333 * reps)`
  - [ ] F√≥rmula promedio de ambas
  - [ ] Validaci√≥n: solo para 1-12 reps

- [ ] **Tracking de Records Personales (PRs)**
  - [ ] Detectar nuevo PR por ejercicio
  - [ ] Guardar hist√≥rico de PRs
  - [ ] Mostrar notificaci√≥n cuando se rompe PR
  - [ ] Pantalla de PRs por ejercicio

##### 2.1.3 Analytics por Grupo Muscular
- [ ] **Mapeo ejercicio ‚Üí grupo muscular**
  - [ ] Crear constante `exerciseMuscleGroupMap`
  - [ ] Categor√≠as: Pecho, Espalda, Piernas, Hombros, Brazos, Core
  - [ ] Asociar cada ejercicio de la API con su grupo

- [ ] **C√°lculos por grupo**
  - [ ] Volumen total por grupo en periodo
  - [ ] Frecuencia de entrenamiento por grupo
  - [ ] Identificar grupos sub-entrenados
  - [ ] Balance muscular (ratio entre grupos)

##### 2.1.4 Providers de Riverpod
- [ ] **Crear providers en `presentation/analytics/`**
  - [ ] `weeklyVolumeProvider` ‚Üí FutureProvider
  - [ ] `muscleGroupStatsProvider` ‚Üí FutureProvider
  - [ ] `consistencyMetricsProvider` ‚Üí FutureProvider
  - [ ] `personalRecordsProvider` ‚Üí StreamProvider
  - [ ] `exerciseProgressProvider(exerciseId)` ‚Üí FutureProvider

#### Estructura de Archivos
```
lib/
‚îú‚îÄ‚îÄ domain/analytics/
‚îÇ   ‚îú‚îÄ‚îÄ analytics_entities.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ analytics_repository.dart (NUEVO)
‚îú‚îÄ‚îÄ application/analytics/
‚îÇ   ‚îú‚îÄ‚îÄ analytics_service.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ one_rep_max_calculator.dart (NUEVO)
‚îú‚îÄ‚îÄ infrastructure/analytics/
‚îÇ   ‚îî‚îÄ‚îÄ analytics_repository_impl.dart (NUEVO)
‚îî‚îÄ‚îÄ presentation/analytics/
    ‚îî‚îÄ‚îÄ analytics_providers.dart (NUEVO)
```

#### Criterios de √âxito
- ‚úÖ Todos los c√°lculos tienen tests unitarios
- ‚úÖ Volumen se calcula correctamente (peso √ó reps √ó sets)
- ‚úÖ 1RM estimado con margen de error <5%
- ‚úÖ Consistencia refleja d√≠as activos reales

---

### M√≥dulo 2.2 - Integraci√≥n de fl_chart
**Prioridad:** üü¢ MEDIA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** M√≥dulo 2.1

#### Tareas

##### 2.2.1 Setup de fl_chart
- [ ] **Instalaci√≥n**
  - [ ] Agregar a `pubspec.yaml`: `fl_chart: ^0.69.0`
  - [ ] Ejecutar `flutter pub get`
  - [ ] Verificar compatibilidad con Flutter actual

##### 2.2.2 Migraci√≥n de Gr√°ficos Existentes
- [ ] **Reemplazar `_SimpleLinePainter` con `LineChart`**
  - [ ] Migrar `MetricChart` a usar fl_chart
  - [ ] Mantener mismo dise√±o visual (azul con gradiente)
  - [ ] A√±adir interactividad (tooltips al tocar)
  - [ ] Animaciones de entrada
  - [ ] Zoom y pan opcionales

- [ ] **Configuraci√≥n de LineChart**
  - [ ] `FlSpot` data points desde `BodyMetric`
  - [ ] `LineTouchData` para interactividad
  - [ ] `FlGridData` para grid lines sutiles
  - [ ] `FlBorderData` para bordes
  - [ ] Colores consistentes con `AppColors`

##### 2.2.3 Nuevo: Gr√°fico de Volumen (Barras)
- [ ] **Crear `VolumeBarChart`**
  - [ ] Mostrar volumen semanal en √∫ltimas 12 semanas
  - [ ] Barras verticales con gradiente
  - [ ] Labels en eje X: "Sem 1", "Sem 2"...
  - [ ] Eje Y: volumen en kg
  - [ ] Touch para ver datos detallados

- [ ] **Integrar en nueva pantalla `AnalyticsScreen`**
  - [ ] Tab "Volumen"
  - [ ] Selector: Semanal / Mensual
  - [ ] Total acumulado debajo del gr√°fico

##### 2.2.4 Nuevo: Distribuci√≥n Muscular (Pie Chart)
- [ ] **Crear `MusclePieChart`**
  - [ ] Mostrar % de volumen por grupo muscular
  - [ ] Colores distintos por grupo
  - [ ] Touch para highlight y mostrar %
  - [ ] Leyenda lateral con nombres

- [ ] **Integrar en `AnalyticsScreen`**
  - [ ] Tab "Distribuci√≥n"
  - [ ] Mostrar √∫ltimo mes
  - [ ] Warnings si hay desbalance >30%

##### 2.2.5 Nuevo: Heatmap de Frecuencia
- [ ] **Crear `FrequencyHeatmap`**
  - [ ] Calendario estilo GitHub contributions
  - [ ] Cada d√≠a coloreado seg√∫n entrenamientos
  - [ ] Verde oscuro = d√≠a entrenado
  - [ ] Gris = d√≠a sin entrenar
  - [ ] Touch para ver detalles del d√≠a

- [ ] **Integrar en `StatisticsScreen`**
  - [ ] Mostrar √∫ltimos 90 d√≠as
  - [ ] Contador de streak actual
  - [ ] D√≠a m√°s productivo del mes

#### Estructura de Archivos
```
lib/presentation/analytics/
‚îú‚îÄ‚îÄ analytics_screen.dart (NUEVO)
‚îú‚îÄ‚îÄ widgets/
‚îÇ   ‚îú‚îÄ‚îÄ volume_bar_chart.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ muscle_pie_chart.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ frequency_heatmap.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ advanced_line_chart.dart (NUEVO - migrado)
‚îî‚îÄ‚îÄ analytics_controller.dart (NUEVO)
```

#### Criterios de √âxito
- ‚úÖ Gr√°ficos se cargan en <1 segundo
- ‚úÖ Interactividad fluida (60 FPS)
- ‚úÖ Dise√±o consistente con resto de app
- ‚úÖ Tooltips informativos y claros

---

### M√≥dulo 2.3 - Pantalla de Estad√≠sticas Mejorada
**Prioridad:** üü¢ MEDIA
**Duraci√≥n:** 1 d√≠a
**Dependencias:** M√≥dulo 2.1, 2.2

#### Tareas
- [ ] **Refactorizar `StatisticsScreen`**
  - [ ] Agregar tabs: General / Volumen / Distribuci√≥n / Frecuencia
  - [ ] Integrar todos los gr√°ficos nuevos
  - [ ] Mostrar KPIs destacados arriba
  - [ ] Selector de periodo global

- [ ] **KPIs principales**
  - [ ] Total entrenamientos (hist√≥rico)
  - [ ] Volumen total levantado
  - [ ] Streak actual de d√≠as
  - [ ] Promedio sesiones/semana

- [ ] **Insights autom√°ticos**
  - [ ] "Has mejorado 15% tu volumen este mes"
  - [ ] "Tu grupo m√°s entrenado: Pecho"
  - [ ] "Llevas 5 d√≠as consecutivos entrenando"
  - [ ] "Nuevo r√©cord personal en Press Banca"

#### Criterios de √âxito
- ‚úÖ Todo carga en <2 segundos
- ‚úÖ Insights son precisos y relevantes
- ‚úÖ Navegaci√≥n intuitiva entre tabs
- ‚úÖ Dise√±o motivador y visual

---

## üìÖ SEMANA 3: UX y Engagement

**Objetivo:** Mejorar experiencia de usuario, onboarding, y sistema de logros

---

### M√≥dulo 3.1 - Sistema de Logros y Gamificaci√≥n
**Prioridad:** üü¢ MEDIA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** Semana 2 completa

#### Tareas

##### 3.1.1 Entidades de Logros
- [ ] **Crear `Achievement` en `domain/gamification/`**
  - [ ] Propiedades: id, name, description, icon, unlockedAt
  - [ ] Enum `AchievementType`: ROUTINE, WORKOUT, METRIC, STREAK, PR
  - [ ] M√©todo: `isUnlocked() ‚Üí bool`
  - [ ] M√©todo: `progress() ‚Üí double` (0.0 - 1.0)

- [ ] **Definir cat√°logo de logros**
  - [ ] "Primera Rutina" - Crear tu primera rutina
  - [ ] "Constante" - 7 d√≠as consecutivos
  - [ ] "Guerrero" - 30 d√≠as consecutivos
  - [ ] "Levantador" - 10,000 kg de volumen total
  - [ ] "Titan" - 100,000 kg de volumen total
  - [ ] "Dedicado" - 50 entrenamientos completados
  - [ ] "Centuria" - 100 entrenamientos completados
  - [ ] "Transformaci√≥n" - Perder 5kg
  - [ ] "Ganancia" - Ganar 5kg de m√∫sculo
  - [ ] "R√©cord" - Romper tu primer PR

##### 3.1.2 Sistema de Streaks
- [ ] **Crear `StreakTracker` en `application/gamification/`**
  - [ ] Calcular streak actual desde `RoutineSession`
  - [ ] Detectar si se rompi√≥ el streak
  - [ ] Calcular streak m√°s largo (hist√≥rico)
  - [ ] Notificar cuando se alcanza milestone

- [ ] **Widget `StreakCounter`**
  - [ ] Mostrar n√∫mero de d√≠as en grande
  - [ ] Icono de fuego animado
  - [ ] Mini-calendario √∫ltimos 7 d√≠as
  - [ ] Mensaje motivacional

##### 3.1.3 UI de Logros
- [ ] **Crear `AchievementsScreen`**
  - [ ] Grid de badges desbloqueados
  - [ ] Badges bloqueados en gris con candado
  - [ ] Progress bar para logros en progreso
  - [ ] Animaci√≥n de confetti al desbloquear

- [ ] **Widget `AchievementBadge`**
  - [ ] Dise√±o circular con icono
  - [ ] Estado: locked / unlocked / in_progress
  - [ ] Tooltip con descripci√≥n y progreso
  - [ ] Shimmer effect en nuevos logros

- [ ] **Notificaciones de logros**
  - [ ] Modal bottom sheet al desbloquear
  - [ ] Animaci√≥n de celebraci√≥n
  - [ ] Share button (compartir en redes)

##### 3.1.4 Integraci√≥n en App
- [ ] **Provider de logros**
  - [ ] `achievementsProvider` ‚Üí StreamProvider
  - [ ] `currentStreakProvider` ‚Üí FutureProvider
  - [ ] Recalcular logros despu√©s de cada sesi√≥n

- [ ] **Agregar a `ProfileScreen`**
  - [ ] Secci√≥n "Logros" con 3 m√°s recientes
  - [ ] Bot√≥n "Ver todos los logros"
  - [ ] Badge de streak prominente

#### Estructura de Archivos
```
lib/
‚îú‚îÄ‚îÄ domain/gamification/
‚îÇ   ‚îú‚îÄ‚îÄ achievement_entities.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ achievement_definitions.dart (NUEVO)
‚îú‚îÄ‚îÄ application/gamification/
‚îÇ   ‚îú‚îÄ‚îÄ achievement_service.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ streak_tracker.dart (NUEVO)
‚îú‚îÄ‚îÄ infrastructure/gamification/
‚îÇ   ‚îî‚îÄ‚îÄ achievement_repository_isar.dart (NUEVO)
‚îî‚îÄ‚îÄ presentation/gamification/
    ‚îú‚îÄ‚îÄ achievements_screen.dart (NUEVO)
    ‚îî‚îÄ‚îÄ widgets/
        ‚îú‚îÄ‚îÄ achievement_badge.dart (NUEVO)
        ‚îú‚îÄ‚îÄ streak_counter.dart (NUEVO)
        ‚îî‚îÄ‚îÄ achievement_unlock_modal.dart (NUEVO)
```

#### Criterios de √âxito
- ‚úÖ Al menos 10 logros definidos
- ‚úÖ Streak se calcula correctamente
- ‚úÖ Badges se desbloquean autom√°ticamente
- ‚úÖ Animaciones fluidas y motivadoras

---

### M√≥dulo 3.2 - Onboarding y Primera Experiencia
**Prioridad:** üü° ALTA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** Ninguna

#### Tareas

##### 3.2.1 Flujo de Onboarding
- [ ] **Crear `OnboardingScreen` con PageView**
  - [ ] P√°gina 1: Bienvenida + logo animado
  - [ ] P√°gina 2: "Crea rutinas personalizadas"
  - [ ] P√°gina 3: "Rastrea tu progreso"
  - [ ] P√°gina 4: "Alcanza tus metas"
  - [ ] Botones: Skip / Next / Empezar

- [ ] **Dise√±o visual**
  - [ ] Ilustraciones o √≠conos grandes
  - [ ] Texto conciso y motivador
  - [ ] Indicadores de p√°gina (dots)
  - [ ] Animaciones de transici√≥n

##### 3.2.2 Configuraci√≥n Inicial
- [ ] **Crear `ProfileSetupScreen`**
  - [ ] Paso 1: Datos b√°sicos (nombre, edad, sexo)
  - [ ] Paso 2: Medidas (altura, peso actual)
  - [ ] Paso 3: Objetivo (perder/ganar/mantener)
  - [ ] Paso 4: Nivel de actividad (sedentario ‚Üí atleta)
  - [ ] Progress indicator arriba

- [ ] **Validaciones**
  - [ ] Edad: 13-100 a√±os
  - [ ] Altura: 100-250 cm
  - [ ] Peso: 20-300 kg
  - [ ] Todos los campos requeridos

##### 3.2.3 Tutorial Interactivo
- [ ] **Primer uso de cada secci√≥n**
  - [ ] Overlay con tooltips en `RoutineListScreen`
  - [ ] Highlight del FAB "Crear rutina"
  - [ ] Explicaci√≥n de botones principales
  - [ ] Dismissible con "Entendido" o X

- [ ] **Coachmarks para gestos**
  - [ ] Swipe para ver detalles
  - [ ] Pull to refresh
  - [ ] Long press para opciones

##### 3.2.4 Persistencia de Estado
- [ ] **Guardar en Isar**
  - [ ] Flag: `hasCompletedOnboarding`
  - [ ] Mostrar onboarding solo en primer inicio
  - [ ] Opci√≥n para ver tutorial nuevamente en Settings

#### Estructura de Archivos
```
lib/presentation/onboarding/
‚îú‚îÄ‚îÄ onboarding_screen.dart (NUEVO)
‚îú‚îÄ‚îÄ profile_setup_screen.dart (NUEVO)
‚îú‚îÄ‚îÄ widgets/
‚îÇ   ‚îú‚îÄ‚îÄ onboarding_page.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ setup_step.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ feature_tooltip.dart (NUEVO)
‚îî‚îÄ‚îÄ onboarding_controller.dart (NUEVO)
```

#### Criterios de √âxito
- ‚úÖ Onboarding aparece solo en primer inicio
- ‚úÖ Usuario puede skip y configurar despu√©s
- ‚úÖ Datos de setup se guardan en perfil
- ‚úÖ Tooltips no son intrusivos

---

### M√≥dulo 3.3 - Mejoras de Input R√°pido y UX
**Prioridad:** üü° ALTA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** Ninguna

#### Tareas

##### 3.3.1 Quick Weight Logger
- [ ] **Crear `QuickWeightLoggerDialog`**
  - [ ] Input num√©rico grande y visible
  - [ ] Botones +0.5 / -0.5 kg
  - [ ] Usar peso anterior como sugerencia
  - [ ] Guardar con 1 tap
  - [ ] Feedback h√°ptico al guardar

- [ ] **Agregar acceso r√°pido**
  - [ ] FAB en `HomeScreen`
  - [ ] Shortcut en `MetricsDashboardScreen`
  - [ ] Quick action desde notification (futuro)

##### 3.3.2 Teclado Num√©rico Optimizado
- [ ] **Crear `NumericInputField` widget**
  - [ ] Teclado num√©rico por defecto
  - [ ] Botones +/- integrados
  - [ ] Incrementos personalizables (1, 5, 10)
  - [ ] Autoselect al enfocar

- [ ] **Aplicar en todos los inputs num√©ricos**
  - [ ] Peso en `AddMeasurementScreen`
  - [ ] Reps/sets en `RoutineBuilderScreen`
  - [ ] Peso/reps en `_LogSetSheet`

##### 3.3.3 Gestos y Atajos
- [ ] **Swipe actions en listas**
  - [ ] Swipe izquierda en rutina ‚Üí Archivar
  - [ ] Swipe derecha en rutina ‚Üí Duplicar
  - [ ] Swipe en sesi√≥n ‚Üí Ver detalles

- [ ] **Long press actions**
  - [ ] Long press en ejercicio ‚Üí Ver info
  - [ ] Long press en m√©trica ‚Üí Editar/eliminar

##### 3.3.4 Feedback H√°ptico
- [ ] **Instalar `vibration: ^2.0.0`**
  - [ ] Vibraci√≥n al completar set
  - [ ] Vibraci√≥n al guardar medida
  - [ ] Vibraci√≥n al desbloquear logro
  - [ ] Vibraci√≥n al romper PR

- [ ] **Crear `HapticService`**
  - [ ] M√©todo: `light()` - feedback sutil
  - [ ] M√©todo: `medium()` - acciones importantes
  - [ ] M√©todo: `heavy()` - celebraciones
  - [ ] Respeta configuraci√≥n del sistema

##### 3.3.5 Autocompletado y Sugerencias
- [ ] **En entrada de peso**
  - [ ] Sugerir peso de √∫ltimo set
  - [ ] Sugerir peso + 2.5kg para progresi√≥n
  - [ ] Chips con sugerencias r√°pidas

- [ ] **En entrada de reps**
  - [ ] Sugerir reps de serie anterior
  - [ ] Sugerir reps del plan de rutina

#### Criterios de √âxito
- ‚úÖ Log de peso toma <5 segundos
- ‚úÖ Teclado num√©rico aparece autom√°ticamente
- ‚úÖ Gestos funcionan intuitivamente
- ‚úÖ Vibraci√≥n respeta preferencias del usuario

---

## üìÖ SEMANA 4: Polish y Features Finales

**Objetivo:** Modo oscuro, export, y refinamiento general

---

### M√≥dulo 4.1 - Modo Oscuro
**Prioridad:** üü¢ MEDIA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** Ninguna

#### Tareas

##### 4.1.1 Definir Paleta Oscura
- [ ] **Extender `AppColors`**
  - [ ] Definir `AppColorsDark` class
  - [ ] Background oscuro: `#121212`
  - [ ] Surface oscuro: `#1E1E1E`
  - [ ] Text primary: `#FFFFFF`
  - [ ] Text secondary: `#B3B3B3`
  - [ ] Accent colors sin cambios
  - [ ] Gradientes ajustados

##### 4.1.2 Implementar ThemeMode
- [ ] **Crear `ThemeModeProvider` (Riverpod)**
  - [ ] State: `ThemeMode` (system/light/dark)
  - [ ] Persistir en Isar (`UserPreferences`)
  - [ ] M√©todo: `toggleTheme()`
  - [ ] M√©todo: `setTheme(ThemeMode)`

- [ ] **Configurar en `MaterialApp`**
  - [ ] `theme: AppTheme.light`
  - [ ] `darkTheme: AppTheme.dark`
  - [ ] `themeMode: themeMode` desde provider

##### 4.1.3 Ajustes por Pantalla
- [ ] **Revisar todas las pantallas**
  - [ ] Usar `Theme.of(context).colorScheme`
  - [ ] Reemplazar colores hardcodeados
  - [ ] Probar en modo oscuro
  - [ ] Ajustar contrastes si es necesario

##### 4.1.4 UI de Configuraci√≥n
- [ ] **Agregar a `SettingsScreen`**
  - [ ] Secci√≥n "Apariencia"
  - [ ] Radio buttons: Sistema / Claro / Oscuro
  - [ ] Preview visual inmediato

#### Criterios de √âxito
- ‚úÖ Cambio de tema sin restart
- ‚úÖ Contraste WCAG AA en modo oscuro
- ‚úÖ Todas las pantallas se ven bien
- ‚úÖ Preferencia persiste entre sesiones

---

### M√≥dulo 4.2 - Export y Compartir
**Prioridad:** üîµ BAJA
**Duraci√≥n:** 1 d√≠a
**Dependencias:** Ninguna

#### Tareas

##### 4.2.1 Export a CSV
- [ ] **Instalar `csv: ^6.0.0`**
- [ ] **Crear `ExportService`**
  - [ ] M√©todo: `exportRoutinesToCsv() ‚Üí String`
  - [ ] M√©todo: `exportMetricsToCsv() ‚Üí String`
  - [ ] M√©todo: `exportSessionsToCsv() ‚Üí String`
  - [ ] Formato: UTF-8 con headers en espa√±ol

##### 4.2.2 Export a JSON
- [ ] **M√©todos de export JSON**
  - [ ] `exportAllData() ‚Üí Map<String, dynamic>`
  - [ ] Incluir: rutinas, m√©tricas, sesiones, perfil
  - [ ] Pretty print con indentaci√≥n
  - [ ] Agregar metadata: version, export_date

##### 4.2.3 Share Functionality
- [ ] **Instalar `share_plus: ^10.0.0`**
- [ ] **Bot√≥n de compartir en `StatisticsScreen`**
  - [ ] Generar imagen de resumen (opcional)
  - [ ] O compartir CSV/JSON
  - [ ] Texto: "Mi progreso en fitness..."

##### 4.2.4 UI de Export
- [ ] **Agregar a `SettingsScreen`**
  - [ ] Secci√≥n "Datos"
  - [ ] Bot√≥n "Exportar Rutinas (CSV)"
  - [ ] Bot√≥n "Exportar M√©tricas (CSV)"
  - [ ] Bot√≥n "Exportar Todo (JSON)"
  - [ ] Confirmaci√≥n antes de exportar

#### Criterios de √âxito
- ‚úÖ CSV se abre correctamente en Excel
- ‚úÖ JSON es v√°lido y legible
- ‚úÖ Share functionality funciona en iOS y Android

---

### M√≥dulo 4.3 - Home Screen Mejorado
**Prioridad:** üü° ALTA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** Semana 2, 3

#### Tareas

##### 4.3.1 Dashboard Principal
- [ ] **Redise√±ar `HomeScreen`**
  - [ ] Secci√≥n Hero: Saludo personalizado + streak
  - [ ] "Tu pr√≥ximo entrenamiento": mostrar rutina programada
  - [ ] Quick stats: volumen semanal, entrenamientos mes, √∫ltimo peso
  - [ ] Gr√°fico mini de progreso de peso (sparkline)

##### 4.3.2 Quick Actions
- [ ] **Botones de acci√≥n r√°pida**
  - [ ] "Iniciar Entrenamiento" ‚Üí Lista de rutinas
  - [ ] "Log Peso" ‚Üí Quick weight logger
  - [ ] "Ver Progreso" ‚Üí Analytics screen
  - [ ] Dise√±o con cards grandes y t√°ctiles

##### 4.3.3 Calendario de Rutinas
- [ ] **Widget `WeeklyRoutineCalendar`**
  - [ ] Mostrar semana actual
  - [ ] D√≠as con rutina programada: highlight
  - [ ] D√≠as completados: checkmark
  - [ ] Tap en d√≠a ‚Üí iniciar rutina

##### 4.3.4 Motivacional
- [ ] **Mensajes din√°micos**
  - [ ] Ma√±ana: "¬°Buenos d√≠as! ¬øListo para entrenar?"
  - [ ] Tarde: "Es buen momento para un workout"
  - [ ] Noche: "Registra tu progreso del d√≠a"
  - [ ] Condicionales seg√∫n streak y progreso

##### 4.3.5 Widget de Logros Recientes
- [ ] **Mostrar √∫ltimos 3 logros**
  - [ ] Badges peque√±os
  - [ ] Tap para ver todos

#### Estructura de Archivos
```
lib/presentation/home/
‚îú‚îÄ‚îÄ home_screen.dart (REFACTOR COMPLETO)
‚îú‚îÄ‚îÄ widgets/
‚îÇ   ‚îú‚îÄ‚îÄ home_hero_section.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ quick_actions_grid.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ weekly_routine_calendar.dart (NUEVO)
‚îÇ   ‚îú‚îÄ‚îÄ mini_progress_chart.dart (NUEVO)
‚îÇ   ‚îî‚îÄ‚îÄ recent_achievements.dart (NUEVO)
‚îî‚îÄ‚îÄ home_controller.dart (MODIFICAR)
```

#### Criterios de √âxito
- ‚úÖ Home carga en <1 segundo
- ‚úÖ Informaci√≥n m√°s importante visible sin scroll
- ‚úÖ CTAs claros y accesibles
- ‚úÖ Dise√±o motivador y personalizado

---

### M√≥dulo 4.4 - Testing Final y Bug Fixes
**Prioridad:** üî¥ CR√çTICA
**Duraci√≥n:** 2 d√≠as
**Dependencias:** Todos los m√≥dulos

#### Tareas

##### 4.4.1 Testing Completo
- [ ] **Test en dispositivos reales**
  - [ ] Android (m√≠nimo 2 dispositivos)
  - [ ] iOS (m√≠nimo 1 dispositivo)
  - [ ] Diferentes tama√±os de pantalla

- [ ] **Flujos completos**
  - [ ] Onboarding ‚Üí crear rutina ‚Üí entrenar ‚Üí ver stats
  - [ ] Log peso ‚Üí ver gr√°fico ‚Üí comparar progreso
  - [ ] Desbloquear logros ‚Üí compartir
  - [ ] Cambiar tema ‚Üí verificar persistencia

##### 4.4.2 Performance
- [ ] **Profiling con DevTools**
  - [ ] Identificar widgets que rebuildan mucho
  - [ ] Optimizar listas largas con `ListView.builder`
  - [ ] Lazy loading de gr√°ficos pesados
  - [ ] Cach√© de im√°genes de ejercicios

- [ ] **Benchmarks**
  - [ ] Tiempo de carga inicial: <3s
  - [ ] Transiciones: >60 FPS
  - [ ] Scroll de listas: sin janks
  - [ ] Gr√°ficos interactivos: sin lag

##### 4.4.3 Bug Triage
- [ ] **Revisar issues conocidos**
  - [ ] Crear lista de bugs pendientes
  - [ ] Priorizar: cr√≠ticos ‚Üí menores
  - [ ] Asignar a m√≥dulos correspondientes
  - [ ] Fix todos los cr√≠ticos

##### 4.4.4 Accesibilidad
- [ ] **Probar con TalkBack/VoiceOver**
  - [ ] Labels claros en todos los botones
  - [ ] Orden de navegaci√≥n l√≥gico
  - [ ] Anuncios importantes
  - [ ] Contraste suficiente

##### 4.4.5 Documentaci√≥n
- [ ] **Actualizar README**
  - [ ] Features implementadas
  - [ ] Screenshots actualizados
  - [ ] Instrucciones de build

- [ ] **Comentarios en c√≥digo**
  - [ ] Documentar funciones complejas
  - [ ] Explicar decisiones de arquitectura
  - [ ] TODOs para futuras mejoras

#### Criterios de √âxito
- ‚úÖ 0 bugs cr√≠ticos
- ‚úÖ App funciona smooth en todos los dispositivos
- ‚úÖ Score de accesibilidad >80
- ‚úÖ Documentaci√≥n completa

---

## üì¶ Dependencias Nuevas a Instalar

### Producci√≥n
```yaml
dependencies:
  # Ya existentes
  flutter:
    sdk: flutter
  http: ^1.2.1
  flutter_riverpod: ^2.4.10
  isar: ^3.1.0+1
  isar_flutter_libs: ^3.1.0+1
  path_provider: ^2.1.3
  uuid: ^4.4.0
  collection: ^1.18.0
  cupertino_icons: ^1.0.8

  # NUEVAS - Semana 2
  fl_chart: ^0.69.0              # Gr√°ficos avanzados

  # NUEVAS - Semana 3
  vibration: ^2.0.0              # Feedback h√°ptico

  # NUEVAS - Semana 4
  share_plus: ^10.0.0            # Compartir datos
  csv: ^6.0.0                    # Export CSV
  wakelock_plus: ^1.2.8          # Mantener pantalla encendida
```

### Desarrollo
```yaml
dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^5.0.0
  build_runner: ^2.4.6
  isar_generator: ^3.1.0+1

  # NUEVAS
  integration_test:              # Tests E2E
    sdk: flutter
  mockito: ^5.4.4                # Mocks para tests
```

---

## üéØ M√©tricas de √âxito del Proyecto

### Semana 1
- [x] Persistencia validada 100%
- [x] Al menos 10 integration tests pasando
- [x] Selector de rango funcional
- [x] Comparativas precisas
- [x] Validaciones en todos los inputs

### Semana 2
- [x] C√°lculos de analytics correctos
- [x] 3 tipos de gr√°ficos con fl_chart funcionando
- [x] Pantalla de analytics completa
- [x] Performance <2s para cargar stats

### Semana 3
- [x] Sistema de logros con 10+ badges
- [x] Onboarding completo y fluido
- [x] Quick logger <5s de uso
- [x] Feedback h√°ptico implementado

### Semana 4
- [x] Modo oscuro sin bugs
- [x] Export funcionando
- [x] Home screen redise√±ado
- [x] 0 bugs cr√≠ticos
- [x] Accesibilidad >80 score

---

## üöÄ Comandos de Implementaci√≥n

### Setup Inicial
```bash
cd my_fitness_tracker
flutter pub get
flutter pub run build_runner build --delete-conflicting-outputs
```

### Testing
```bash
# Unit tests
flutter test

# Integration tests
flutter test integration_test/

# Widget tests espec√≠ficos
flutter test test/presentation/
```

### Build
```bash
# Debug
flutter run

# Release Android
flutter build apk --release

# Release iOS
flutter build ios --release
```

### An√°lisis
```bash
flutter analyze
flutter pub run dart_code_metrics:metrics analyze lib

# Performance profiling
flutter run --profile
# Abrir DevTools
```

---

## üìù Notas Finales

### Prioridades si hay Retrasos
1. **NO NEGOCIABLE:** M√≥dulo 1.1 y 1.2 (Persistencia)
2. **ALTA:** M√≥dulo 2.1 (Analytics b√°sico)
3. **MEDIA:** M√≥dulo 3.2 (Onboarding)
4. **BAJA:** M√≥dulo 4.2 (Export)

### Futuras Mejoras (Post-Plan)
- [ ] Sincronizaci√≥n en nube (Firebase/Supabase)
- [ ] Integraci√≥n con wearables (Apple Watch, Garmin)
- [ ] Planes de entrenamiento con IA
- [ ] Comunidad y comparaci√≥n con amigos
- [ ] Marketplace de rutinas
- [ ] Timer con control de voz

### Recursos √ötiles
- **Isar Docs:** https://isar.dev/
- **Riverpod:** https://riverpod.dev/
- **fl_chart Gallery:** https://github.com/imaNNeo/fl_chart
- **Material 3:** https://m3.material.io/

---

**Documento creado:** Octubre 2024
**√öltima actualizaci√≥n:** Octubre 2024
**Versi√≥n:** 1.0
**Mantenedor:** Equipo de Desarrollo My Fitness Tracker
